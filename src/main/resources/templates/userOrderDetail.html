<!DOCTYPE html>
<html lang="en" xmlns:th="http://thymeLeaf.org">

<head>
  <!--⚠ this page is for ADMIN -->
  <meta charset="UTF-8">
  <title>Detail</title>
  <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"
        integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" rel="stylesheet">
  <script crossorigin="anonymous" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
          src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <!--css for rating-->
  <link href="../static/css/detail.css" rel="stylesheet">

</head>

<body>
<!--make detail page with bootstrap with left is service image with service name and right is detail -->
<div class="container" style="margin-top: 10px;">
  <h1 class="" style="margin-bottom: 30px; text-align:center;" th:text="${orderDetail != null} ? ${orderDetail.account.accountName} + '\'s order detail' : ''"></h1>
  <div class="row justify-content-center">
    <div class="col-sm-6 col-lg-8 border border-dark rounded">
      <!--design table that has order id, order date, work date, service id, price, payment name, status on same row, below row is service description and more below
  is rating and comment-->
      <table class="table" id="order-table">
        <thead>
        <tr>
          <th class="text-center">Order ID</th>
          <th class="text-center">Order Date</th>
          <th class="text-center">Work Date</th>
          <th class="text-center">Service Name</th>
          <th class="text-center">Price</th>
          <th class="text-center">Payment Name</th>
          <th class="text-center">Status</th>
        </tr>
        </thead>
        <tbody>
        <tr th:switch="${order.status}" th:each="order : ${orderDetail}">
          <td th:text="${orderDetail != null} ? ${order.orderId} : ''" class="text-center"></td>
          <td th:text="${orderDetail != null} ? ${order.createTime} : ''" class="text-center"></td>
          <td th:text="${orderDetail != null} ? ${order.schedule.workDay} : ''" class="text-center"></td>
          <td th:text="${orderDetail != null} ? ${order.service.serviceName} : ''" class="text-center"></td>
          <td th:text="${orderDetail != null} ? ${order.service.price} + '$' : ''" class="text-center"></td>
          <td th:text="${orderDetail != null} ? ${order.payment.paymentName} : ''" class="text-center"></td>
          <td th:case="0" class="text-center">Pending</td>
          <td th:case="1" class="text-center">Accepted</td>
          <td th:case="2" class="text-center">Rejected</td>
          <td th:case="3" class="text-center">Completed</td>
          <td th:case="4" class="text-center">Canceled</td>
        </tbody>
      </table>
      <div class="row">
        <div class="col-lg-12 border border-dark">
          <h4 style="text-align: center;">Service Description</h4>
          <p id="service-description" style="text-align:center;" th:text="${orderDetail != null} ? ${orderDetail.service.description} : ''"></p>
        </div>
        <div class="col-lg-12 border border-dark">
          <h4 style="text-align:center;">Review</h4>
          <div class="row">
            <div class="col-sm-6 col-lg-5 border border-dark">
              <h5>Rating</h5>
              <p id="rating" th:attr="data-rating=${orderDetail.rating}"></p>
            </div>
            <div class="col-sm-6 col-lg-7 border border-dark">
              <h5>Comment</h5>
              <p id="comment" th:text="${orderDetail != null} ? ${orderDetail.comment} : ''"></p>
            </div>
          </div>
        </div>
      </div>
      <!--last row for list of workers-->
      <div class="row">
        <div class="col-sm-6 col-lg-12 border border-dark">
          <h4 style="text-align: center;">Workers</h4>

          <!--worker table with worker first name, last name and divide into 2 equal column with bootstrap-->
          <table class="table">
            <thead>
            <tr>
              <th class="text-center">First Name</th>
              <th class="text-center">Last Name</th>
            </tr>
            </thead>
            <tbody id="worker-table-body">
              <tr th:each="worker: ${orderDetail.schedule.workers}">
                <td class="text-center" th:text="${orderDetail != null} ? ${worker.firstName} : ''"></td>
                <td class="text-center" th:text="${orderDetail != null} ? ${worker.lastName} : ''"></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

</div>
<script>
  const rating = document.getElementById('rating');
  const numOfStar = parseInt(rating.dataset.rating);
  rating.innerHTML = Array(numOfStar).fill().map((_, i) => ('<span>⭐</span>')).join('')
</script>
</body>

</html>