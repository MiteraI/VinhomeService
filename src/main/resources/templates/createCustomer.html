<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>test-admin</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
  <link rel="stylesheet" href="../static/css/index.css">
</head>

<body>
  <div class="overlay">

    <div class="container ">

      <div class="container col-6 border border-black p-lg-3 rounded mt-5">
        <form id="create-form" class="">
          <div class="form-group">
            <label> Username</label>
            <input type="text" class="form-control form-control-sm" aria-describedby="emailHelp" placeholder=""
              name="txtUsername" value="">
            <p id="error-username" class="error-message" style="visibility: hidden;">adsf</p>
          </div>
          <div class="form-group">
            <label> Password</label>
            <input type="password" class="form-control form-control-sm" placeholder="" name="txtPassword">
            <p id="error-password" class="error-message" style="visibility: hidden;">adsf</p>
          </div>
          <div class="form-group">
            <label> Email</label>
            <input type="text" class="form-control form-control-sm" placeholder="" name="txtEmail">
            <p id="error-email" class="error-message" style="visibility: hidden;">adsf</p>
          </div>
          <div class="form-group">
            <label> Firstname</label>
            <input type="text" class="form-control form-control-sm" placeholder="" name="txtFirstname">
            <p id="error-firstname" class="error-message" style="visibility: hidden;">adsf</p>
          </div>
          <div class="form-group">
            <label> Lastname</label>
            <input type="text" class="form-control form-control-sm" placeholder="" name="txtLastname">
            <p id="error-lastname" class="error-message" style="visibility: hidden;">adsf</p>
          </div>
          <div class="form-group">
            <label> Dob</label>
            <input type="date" class="form-control" placeholder="" name="txtDate">
            <p id="error-dob" class="error-message" style="visibility: hidden;">adsf</p>
          </div>
          <div class="form-group">
            <label> PhoneNumber</label>
            <input type="text" class="form-control form-control-sm" placeholder="" name="txtPhonenumber">
            <p id="error-phonenumber" class="error-message" style="visibility: hidden;">adsf</p>
          </div>
          <div class="form-group">
            <label> block&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
            <input type="radio" class="form-check-input" name="btnRadio" value="A" checked="checked"> block A
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="radio" class="form-check-input" name="btnRadio" value="B">block B
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="radio" class="form-check-input" name="btnRadio" value="C"> block C </td>
            </br>
          </div>
          <div class="form-group">
            <label> Room</label>
            <input type="text" class="form-control form-control-sm" placeholder="" name="txtRoomnumber">
            <p id="error-address" class="error-message" style="visibility: hidden;">adsf</p>
          </div>
          <div class="container-fluid d-flex justify-content-around align-items-center">
            <div>
              <input type="radio" name="btnVerification" value="emailVerification"> Email verification
            </div>
            <div>
              <input type="radio" name="btnVerification" value="smsVerficication" checked> SMS verification
            </div>
          </div>

          <div>
            <input class="btn btn-primary button-submit" type="submit" value="Submit">
            <button class="btn btn-primary " onclick="getHomePage()"> Home</button>
          </div>
          
        </form>



      </div>
    </div>
  </div>

</body>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
<script src="../static/js/AdminPublicFunction.js"></script>
<script>
  const form_create = document.getElementById("create-form");

  form_create.addEventListener('submit', async function (event) {
    console.log(form_create)
    event.preventDefault();
    var username = document.getElementById("USERNAME")
    const form_data = new FormData(form_create);
    const data = Object.fromEntries(form_data);
    const submitBtn = document.querySelector('.button-submit');
    console.log(data);
    console.log(data["txtUsername"])
    submitBtn.classList.add('disabled');
    const response = await fetch("/createAccountAPI/createAccountCustomer/0",
      {
        method: "POST",
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
      });


    var status = response.status; console.log(status)
    var bodyJson = response.json()
    if (status < 200 || status > 300) {
      error_username.style.visibility = "visible"; error_username.innerHTML = '❌ ' + "." + responseData.usernameErr
      error_password.stylse.visibility = "visible"; error_password.innerHTML ='❌ ' + "." + responseData.passwordErr
      error_email.style.visibility = "visible"; error_email.innerHTML = '❌ ' + "." + responseData.emailErr
      error_firstname.style.visibility = "visible"; error_firstname.innerHTML = '❌ ' + "." + responseData.firstnameErr
      error_lastname.style.visibility = "visible"; error_lastname.innerHTML = '❌ ' + "." + responseData.lastnameErr
      error_dob.style.visibility = "visible"; error_dob.innerHTML = '❌ ' + "." + responseData.dateErr
      error_phonenumber.style.visibility = "visible"; error_phonenumber.innerHTML = '❌ ' + "." + responseData.phonenumberErr
      error_address.style.visibility = "visible"; error_address.innerHTML = '❌ ' + "." + responseData.addressErr
          if (responseData.usernameErr == "") { error_username.innerHTML= "✔"; }
          if (responseData.emailErr == "") { error_email.innerHTML = "✔"; }
          if (responseData.firstnameErr == "") { error_firstname.innerHTML= "✔"; }
          if (responseData.lastnameErr == "") { error_lastname.innerHTML = "✔"; }
          if (responseData.dateErr == "") { error_dob.innerHTML = "✔"; }
          if (responseData.phonenumberErr == "") { error_phonenumber.innerHTML = "✔"; }
          if (responseData.addressErr == "") { error_address.innerHTML= "✔"; }
    } else {
      error_username.style.visibility = "visible";
      error_password.stylse.visibility = "visible";
      error_email.style.visibility = "visible";
      error_firstname.style.visibility = "visible";
      error_lastname.style.visibility = "visible";
      error_dob.style.visibility = "visible";
      error_phonenumber.style.visibility = "visible";
      error_address.style.visibility = "visible";
          error_username.innerHTML = "✔";
          error_password.innerHTML = "✔"; 
          error_email.innerHTML = "✔";
          error_firstname.innerHTML = "✔";
          error_lastname.innerHTML = "✔";
          error_dob.innerHTML = "✔";
          error_phonenumber.innerHTML = "✔";
          error_address.innerHTML = "✔";
      console.log('yes successs')
      alert("successfully update");
      delay(500).then(() => {
        alert("success, go to verification")
         window.location.replace(`http://localhost:8080/verification/${data["txtUsername"]}`)
      })
    }
    // if (status == 400) {
    //     error_message = await response.json()
    //     error_message = Object.fromEntries(Object.entries(error_message).filter(([_, v]) => v != null));
    //     console.log(error_message)
    //     var list = document.getElementsByClassName("error-message");
    //     var i = 0;
    //     for (var key in error_message) {
    //         if (error_message[key] !== "") {
    //             list[i].classList.remove('d-none')
    //             list[i].innerHTML = '❌ ' + error_message[key];
    //         } else {
    //             list[i].classList.remove('d-none')
    //             list[i].innerHTML = "✔";
    //         }
    //         i += 1;


    //     }
    //     submitBtn.classList.remove('disabled');


    // } else if (response.status == 200) {
    //     console.log('yes successs');
    //     submitBtn.classList.remove('disabled');
    //     console.log(data["txtUsername"])

    //     alert("success, go to verification")
    //     window.location.replace(`http://localhost:8080/verification/${data["txtUsername"]}`)


    // } else if (response.status == 500) {
    //     error_message = await response.json()
    //     var list = document.getElementsByClassName("error-message");
    //     var i = 0;
    //     for (var key in error_message) {
    //         if (error_message[key] == "") {
    //             list[i].innerHTML = "appropriate input";
    //             list[i].style.visibility = "hidden";
    //             i += 1;
    //         }
    //     }
    //     submitBtn.classList.remove('disabled');
    //     alert("something wrong with server side, please try again later");
    // }
  })
</script>

</html>